<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--  <meta charset="UTF-8">-->
<!--  <title>Magic Mat Game</title>-->
<!--  <style>-->
<!--    body { font-family: sans-serif; text-align: center; padding: 20px; }-->
<!--    .options { display: flex; justify-content: center; gap: 40px; margin-top: 20px; }-->
<!--    .option { cursor: pointer; }-->
<!--    img { width: 120px; height: 120px; border: 2px solid #ccc; border-radius: 8px; }-->
<!--    .feedback { font-size: 28px; margin-top: 20px; }-->
<!--  </style>-->
<!--</head>-->
<!--<body>-->
<!--  <h1 id="question">Loading...</h1>-->
<!--  <div class="options" id="options"></div>-->
<!--  <div class="feedback" id="feedback"></div>-->
<!--&lt;!&ndash; for mouse outpu&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&ndash;&gt;-->
<!--&lt;!&ndash;  <script>&ndash;&gt;-->
<!--&lt;!&ndash;    let currentPuzzle = 0;&ndash;&gt;-->

<!--&lt;!&ndash;    function loadPuzzle() {&ndash;&gt;-->
<!--&lt;!&ndash;      fetch(`/get_puzzle/${currentPuzzle}`)&ndash;&gt;-->
<!--&lt;!&ndash;        .then(res => res.json())&ndash;&gt;-->
<!--&lt;!&ndash;        .then(data => {&ndash;&gt;-->
<!--&lt;!&ndash;          if (data.done) {&ndash;&gt;-->
<!--&lt;!&ndash;            document.getElementById("question").innerText = "ðŸŽ‰ You're done!";&ndash;&gt;-->
<!--&lt;!&ndash;            document.getElementById("options").innerHTML = "";&ndash;&gt;-->
<!--&lt;!&ndash;            return;&ndash;&gt;-->
<!--&lt;!&ndash;          }&ndash;&gt;-->
<!--&lt;!&ndash;          document.getElementById("question").innerText = data.question;&ndash;&gt;-->
<!--&lt;!&ndash;          document.getElementById("feedback").innerText = "";&ndash;&gt;-->
<!--&lt;!&ndash;          const optionsDiv = document.getElementById("options");&ndash;&gt;-->
<!--&lt;!&ndash;          optionsDiv.innerHTML = "";&ndash;&gt;-->
<!--&lt;!&ndash;          data.options.forEach(opt => {&ndash;&gt;-->
<!--&lt;!&ndash;            const div = document.createElement("div");&ndash;&gt;-->
<!--&lt;!&ndash;            div.className = "option";&ndash;&gt;-->
<!--&lt;!&ndash;            div.innerHTML = `&ndash;&gt;-->
<!--&lt;!&ndash;              <img src="/static/images/${opt.image}" alt="${opt.label}">&ndash;&gt;-->
<!--&lt;!&ndash;              <div>${opt.label}</div>&ndash;&gt;-->
<!--&lt;!&ndash;            `;&ndash;&gt;-->
<!--&lt;!&ndash;            div.onclick = () => checkAnswer(opt.label);&ndash;&gt;-->
<!--&lt;!&ndash;            optionsDiv.appendChild(div);&ndash;&gt;-->
<!--&lt;!&ndash;          });&ndash;&gt;-->
<!--&lt;!&ndash;        });&ndash;&gt;-->
<!--&lt;!&ndash;    }&ndash;&gt;-->

<!--&lt;!&ndash;    function checkAnswer(answer) {&ndash;&gt;-->
<!--&lt;!&ndash;      fetch("/check_answer", {&ndash;&gt;-->
<!--&lt;!&ndash;        method: "POST",&ndash;&gt;-->
<!--&lt;!&ndash;        headers: { "Content-Type": "application/json" },&ndash;&gt;-->
<!--&lt;!&ndash;        body: JSON.stringify({ index: currentPuzzle, answer })&ndash;&gt;-->
<!--&lt;!&ndash;      })&ndash;&gt;-->
<!--&lt;!&ndash;      .then(res => res.json())&ndash;&gt;-->
<!--&lt;!&ndash;      .then(result => {&ndash;&gt;-->
<!--&lt;!&ndash;        const feedback = document.getElementById("feedback");&ndash;&gt;-->
<!--&lt;!&ndash;        if (result.correct) {&ndash;&gt;-->
<!--&lt;!&ndash;          feedback.innerText = "ðŸŽ‰ Hurray! Correct!";&ndash;&gt;-->
<!--&lt;!&ndash;          feedback.style.color = "green";&ndash;&gt;-->
<!--&lt;!&ndash;        } else {&ndash;&gt;-->
<!--&lt;!&ndash;          feedback.innerText = "ðŸ˜ž Oops! Try Again.";&ndash;&gt;-->
<!--&lt;!&ndash;          feedback.style.color = "red";&ndash;&gt;-->
<!--&lt;!&ndash;        }&ndash;&gt;-->
<!--&lt;!&ndash;        setTimeout(() => {&ndash;&gt;-->
<!--&lt;!&ndash;          currentPuzzle++;&ndash;&gt;-->
<!--&lt;!&ndash;          loadPuzzle();&ndash;&gt;-->
<!--&lt;!&ndash;        }, 1500);&ndash;&gt;-->
<!--&lt;!&ndash;      });&ndash;&gt;-->
<!--&lt;!&ndash;    }&ndash;&gt;-->

<!--&lt;!&ndash;    loadPuzzle();&ndash;&gt;-->
<!--&lt;!&ndash;  </script>&ndash;&gt;-->

<!--&lt;!&ndash; -&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&ndash;&gt;-->

<!--  &lt;!&ndash; for keyboard output&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&ndash;&gt;-->
<!--<script>-->
<!--  let currentPuzzle = 0;-->
<!--  let currentOptions = [];-->

<!--  function loadPuzzle() {-->
<!--    fetch(`/get_puzzle/${currentPuzzle}`)-->
<!--      .then(res => res.json())-->
<!--      .then(data => {-->
<!--        if (data.done) {-->
<!--          document.getElementById("question").innerText = "ðŸŽ‰ You're done!";-->
<!--          document.getElementById("options").innerHTML = "";-->
<!--          return;-->
<!--        }-->

<!--        document.getElementById("question").innerText = data.question;-->
<!--        document.getElementById("feedback").innerText = "";-->
<!--        const optionsDiv = document.getElementById("options");-->
<!--        optionsDiv.innerHTML = "";-->

<!--        currentOptions = data.options.map(opt => opt.label);  // Save valid keys (A, B, C)-->

<!--        data.options.forEach(opt => {-->
<!--          const div = document.createElement("div");-->
<!--          div.className = "option";-->
<!--          div.innerHTML = `-->
<!--            <img src="/static/images/${opt.image}" alt="${opt.label}">-->
<!--            <div>${opt.label}</div>-->
<!--          `;-->
<!--          optionsDiv.appendChild(div);-->
<!--        });-->
<!--      });-->
<!--  }-->

<!--  function checkAnswer(answer) {-->
<!--    fetch("/check_answer", {-->
<!--      method: "POST",-->
<!--      headers: { "Content-Type": "application/json" },-->
<!--      body: JSON.stringify({ index: currentPuzzle, answer })-->
<!--    })-->
<!--    .then(res => res.json())-->
<!--    .then(result => {-->
<!--      const feedback = document.getElementById("feedback");-->
<!--      if (result.correct) {-->
<!--        feedback.innerText = "ðŸŽ‰ Hurray! Correct!";-->
<!--        feedback.style.color = "green";-->
<!--      } else {-->
<!--        feedback.innerText = "ðŸ˜ž Oops! Try Again.";-->
<!--        feedback.style.color = "red";-->
<!--      }-->
<!--      setTimeout(() => {-->
<!--        currentPuzzle++;-->
<!--        loadPuzzle();-->
<!--      }, 1500);-->
<!--    });-->
<!--  }-->

<!--  // ðŸ”‘ Keyboard input support-->
<!--  document.addEventListener("keydown", (event) => {-->
<!--    const key = event.key.toUpperCase();-->
<!--    if (currentOptions.includes(key)) {-->
<!--      checkAnswer(key);-->
<!--    }-->
<!--  });-->

<!--  loadPuzzle();-->
<!--</script>-->
<!--  &lt;!&ndash; -&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&ndash;&gt;-->

<!--</body>-->
<!--</html>-->





<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Magic Mat Game</title>
  <style>
    body { font-family: sans-serif; text-align: center; padding: 20px; }
    .options { display: flex; justify-content: center; gap: 40px; margin-top: 20px; }
    .option { cursor: pointer; }
    img { width: 120px; height: 120px; border: 2px solid #ccc; border-radius: 8px; }
    .feedback { font-size: 28px; margin-top: 20px; }
  </style>
</head>
<body>
  <h1 id="question">Loading...</h1>
  <div class="options" id="options"></div>
  <div class="feedback" id="feedback"></div>

  <!-- ðŸŽµ Sound elements -->
  <audio id="sound-correct" src="/static/sounds/victory.mp3"></audio>
  <audio id="sound-wrong" src="/static/sounds/sad.mp3"></audio>

  <script>
    let currentPuzzle = 0;
    let currentOptions = [];
    let attemptsLeft = 3;

    function loadPuzzle() {
      fetch(`/get_puzzle/${currentPuzzle}`)
        .then(res => res.json())
        .then(data => {
          if (data.done) {
            document.getElementById("question").innerText = "ðŸŽ‰ You're done!";
            document.getElementById("options").innerHTML = "";
            return;
          }

          document.getElementById("question").innerText = data.question;
          document.getElementById("feedback").innerText = "";
          const optionsDiv = document.getElementById("options");
          optionsDiv.innerHTML = "";

          currentOptions = data.options.map(opt => opt.label);  // Save valid keys (A, B, C)
          attemptsLeft = 3;  // Reset attempts

          data.options.forEach(opt => {
            const div = document.createElement("div");
            div.className = "option";
            div.innerHTML = `
              <img src="/static/images/${opt.image}" alt="${opt.label}">
              <div>${opt.label}</div>
            `;
            optionsDiv.appendChild(div);
          });
        });
    }

    function checkAnswer(answer) {
      fetch("/check_answer", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ index: currentPuzzle, answer })
      })
      .then(res => res.json())
      .then(result => {
        const feedback = document.getElementById("feedback");

        if (result.correct) {
          feedback.innerText = "ðŸŽ‰ Hurray! Correct!";
          feedback.style.color = "green";
          document.getElementById("sound-correct").play();

          setTimeout(() => {
            currentPuzzle++;
            loadPuzzle();
          }, 2000);
        } else {
          attemptsLeft--;
          feedback.innerText = `ðŸ˜ž Oops! Try Again. Attempts left: ${attemptsLeft}`;
          feedback.style.color = "red";
          document.getElementById("sound-wrong").play();

          if (attemptsLeft <= 0) {
            setTimeout(() => {
              currentPuzzle++;
              loadPuzzle();
            }, 2000);
          }
        }
      });
    }

    // Keyboard input
    document.addEventListener("keydown", (event) => {
      const key = event.key.toUpperCase();
      if (currentOptions.includes(key)) {
        checkAnswer(key);
      }
    });

    loadPuzzle();
  </script>
</body>
</html>
